---
import { SEO as AstroSEO } from "astro-seo";

interface Props {
  title: string;
  description?: string;
  image?: string;
  imageAlt?: string;
  noindex?: boolean;
  nofollow?: boolean;
  article?: {
    publishedTime?: string;
    modifiedTime?: string;
    authors?: string[];
    tags?: string[];
  };
}

const SITE_NAME = "Haebot Store";
const SITE_URL = "https://store.haebot.com";
const DEFAULT_DESCRIPTION =
  "Jual perlengkapan industri CNC terlengkap — spare parts, suku cadang mesin, tooling, konsultasi teknis, manufaktur mesin, dan pembelian alat industri. Distributor resmi peralatan CNC berkualitas tinggi di Indonesia, Jawa Timur, Kota Blitar.";
const DEFAULT_IMAGE = `${SITE_URL}/images/seo-default.png`;
const DEFAULT_IMAGE_ALT =
  "Haebot Store — Distributor Suku Cadang dan Peralatan CNC Indonesia";
const FACEBOOK_URL =
  "https://www.facebook.com/people/Haebot-Teknologi/61561255135421/";

const SEO_KEYWORDS = [
  // Core business
  "CNC",
  "suku cadang CNC",
  "spare parts CNC",
  "peralatan CNC",
  "mesin CNC",
  "tooling CNC",
  // Services
  "konsultasi teknis CNC",
  "konsultasi mesin industri",
  "manufaktur mesin",
  "pembelian alat industri",
  "jasa manufaktur",
  // Products
  "milling",
  "turning",
  "spare parts mesin",
  "suku cadang mesin bubut",
  "suku cadang mesin milling",
  "cutting tools",
  "collet chuck",
  "ball screw",
  "linear guide",
  "spindle motor",
  // Location
  "Indonesia",
  "Jawa Timur",
  "Kota Blitar",
  "Blitar",
  // Business type
  "distributor CNC",
  "distributor resmi",
  "toko mesin industri",
  "supplier CNC Indonesia",
  "distributor suku cadang CNC Jawa Timur",
  // Industry
  "industri manufaktur",
  "pemesinan presisi",
  "industrial equipment",
  "precision machining",
].join(", ");

const {
  title,
  description = DEFAULT_DESCRIPTION,
  image = DEFAULT_IMAGE,
  imageAlt = DEFAULT_IMAGE_ALT,
  noindex = false,
  nofollow = false,
  article,
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, SITE_URL).href;
const ogTitle = `${title} | ${SITE_NAME}`;

// JSON-LD Organization Schema
const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  name: SITE_NAME,
  url: SITE_URL,
  logo: `${SITE_URL}/images/logo-schema.png`,
  description: DEFAULT_DESCRIPTION,
  contactPoint: {
    "@type": "ContactPoint",
    telephone: "+62-852-4642-8746",
    contactType: "customer service",
    areaServed: "ID",
    availableLanguage: ["Indonesian", "English"],
  },
  address: {
    "@type": "PostalAddress",
    addressLocality: "Kota Blitar",
    addressRegion: "Jawa Timur",
    addressCountry: "ID",
  },
  sameAs: [FACEBOOK_URL],
};

// JSON-LD WebSite Schema (for sitelinks search box)
const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  name: SITE_NAME,
  url: SITE_URL,
  potentialAction: {
    "@type": "SearchAction",
    target: {
      "@type": "EntryPoint",
      urlTemplate: `${SITE_URL}/katalog?search={search_term_string}`,
    },
    "query-input": "required name=search_term_string",
  },
};
---

<AstroSEO
  title={title}
  titleTemplate={`%s | ${SITE_NAME}`}
  titleDefault={SITE_NAME}
  description={description}
  canonical={canonicalURL}
  noindex={noindex}
  nofollow={nofollow}
  openGraph={{
    basic: {
      title: ogTitle,
      type: article ? "article" : "website",
      image: image,
      url: canonicalURL,
    },
    optional: {
      description: description,
      locale: "id_ID",
      siteName: SITE_NAME,
    },
    image: {
      url: image,
      alt: imageAlt,
      width: 1200,
      height: 630,
      type: "image/png",
    },
    ...(article
      ? {
          article: {
            publishedTime: article.publishedTime,
            modifiedTime: article.modifiedTime,
            authors: article.authors,
            tags: article.tags,
          },
        }
      : {}),
  }}
  twitter={{
    card: "summary_large_image",
    title: ogTitle,
    description: description,
    image: image,
    imageAlt: imageAlt,
  }}
  extend={{
    meta: [
      { name: "keywords", content: SEO_KEYWORDS },
      { name: "author", content: SITE_NAME },
      {
        name: "theme-color",
        content: "#1a1a2e",
      },
      { property: "fb:page_id", content: "61561255135421" },
    ],
    link: [
      { rel: "icon", type: "image/svg+xml", href: "/favicon.svg" },
      { rel: "sitemap", href: "/sitemap-index.xml" },
    ],
  }}
/>

{/* JSON-LD Structured Data */}
<script
  type="application/ld+json"
  set:html={JSON.stringify(organizationSchema)}
/>
<script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
